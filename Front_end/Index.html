<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="App.css">

</head>
<body>
    <div class="container"> 
        <h1>Classificador de Produtividade de E-mails</h1> 
         <form id="emailForm">
             <label for="emailInput">Conteúdo do E-mail:</label>
              <textarea id="emailInput" placeholder="Cole aqui o texto completo do e-mail..." required></textarea>
               <button type="submit">Classificar e Sugerir Resposta</button> 
            </form>
             <div id="results"> 
                <h2>Resultados da Classificação</h2>
                 <p id="loadingMessage" style="color: #008B8B; display: none;">Processando... Aguarde a resposta do modelo de IA...</p> 
                 <div class="result-item">
                     <strong>Classificação:</strong>
                      <span id="classificationResult">Aguardando envio...</span>
                     </div> 
                     <div class="result-item"> 
                        <strong>Resposta Sugerida:</strong>
                         <pre id="responseResult" style="white-space: pre-wrap; background-color: white; padding: 10px; border-radius: 4px;"></pre>
                         </div>
                         </div> 
                        </div> 
                <script>
                 document.getElementById('emailForm').addEventListener('submit', async (e) => { e.preventDefault(); 
                   
                  const emailText = document.getElementById('emailInput').value; 
                  const loadingMessage = document.getElementById('loadingMessage');
                   const classificationResult = document.getElementById('classificationResult'); 
                   const responseResult = document.getElementById('responseResult'); 
                  
                   classificationResult.textContent = 'Processando...'; responseResult.textContent = 'Processando...'; loadingMessage.style.display = 'block'; 
                  
                   const backendUrl = 'http://127.0.0.1:8000/process_email/'; 
                   try { 
                    const response = await fetch(backendUrl, { 
                        method: 'POST', headers: { 'Content-Type': 'application/json' }, 
                        body: JSON.stringify({ email_text: emailText }) });
                  
                     if (!response.ok) {
                         throw new Error("Erro do servidor: ${response.status} ${response.statusText}"); } 
                     const result = await response.json(); 
                    
                      classificationResult.textContent = result.classification || 'Erro ao classificar'; responseResult.textContent = result.suggested_response || 'Erro ao gerar resposta'; 
                    } catch (error) { 
                        console.error('Falha ao conectar com o backend:', error); classificationResult.textContent = 'ERRO DE CONEXÃO';
                         responseResult.textContent = "Não foi possível conectar ao servidor FastAPI. Verifique se o backend está rodando em ${backendUrl}. Detalhe: ${error.message}"; 
                    } finally { 
                        
                    loadingMessage.style.display = 'none'; } });
                     </script>
                     <script src="App.js"></script>
</body>
</html>